import pytest


@pytest.fixture
def excel_data() -> list[dict]:
    """Фикстура тестирования данных с excel."""

    return [
        {
            "Дата операции": "25.01.2018 20:14:08",
            "Дата платежа": "25.01.2018",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": 9700.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 9700.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Пополнения",
            "MCC": 6012.0,
            "Описание": "Перевод с карты",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 9700.0,
        },
        {
            "Дата операции": "25.01.2018 14:49:57",
            "Дата платежа": "27.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -295.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -295.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "OOO Frittella",
            "Бонусы (включая кэшбэк)": 5,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 295.0,
        },
        {
            "Дата операции": "25.01.2018 09:53:50",
            "Дата платежа": "26.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -64.62,
            "Валюта операции": "RUB",
            "Сумма платежа": -64.62,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Billa",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 64.62,
        },
        {
            "Дата операции": "24.01.2018 22:53:54",
            "Дата платежа": "25.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -5748.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -5748.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Авиабилеты",
            "MCC": 4511.0,
            "Описание": "Aviacassa",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 5748.0,
        },
        {
            "Дата операции": "24.01.2018 13:59:06",
            "Дата платежа": "26.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -325.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -325.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "OOO Frittella",
            "Бонусы (включая кэшбэк)": 6,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 325.0,
        },
        {
            "Дата операции": "24.01.2018 00:00:00",
            "Дата платежа": "26.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -375.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -375.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Транспорт",
            "MCC": 4121.0,
            "Описание": "Яндекс Такси",
            "Бонусы (включая кэшбэк)": 7,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 375.0,
        },
        {
            "Дата операции": "24.01.2018 00:00:00",
            "Дата платежа": "25.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -376.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -376.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Транспорт",
            "MCC": 4121.0,
            "Описание": "Яндекс Такси",
            "Бонусы (включая кэшбэк)": 7,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 376.0,
        },
        {
            "Дата операции": "23.01.2018 22:38:17",
            "Дата платежа": "24.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -840.3,
            "Валюта операции": "RUB",
            "Сумма платежа": -840.3,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Ж/д билеты",
            "MCC": 4112.0,
            "Описание": "РЖД",
            "Бонусы (включая кэшбэк)": 16,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 840.3,
        },
        {
            "Дата операции": "23.01.2018 21:39:01",
            "Дата платежа": "24.01.2018",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": 115909.42,
            "Валюта операции": "RUB",
            "Сумма платежа": 115909.42,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Перевод Кредитная карта. ТП 10.2 RUR",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 115909.42,
        },
    ]


@pytest.fixture
def dict_data() -> list[dict]:
    """Фикстура для теста services."""

    return [
        {
            "date of operation": "12.02.2017 17:47:21",
            "date of currency": "14.02.2018",
            "card number": "*7197",
            "status": "OK",
            "operation": {"add": -98.41, "currency": "RUB"},
            "add": -98.41,
            "currency": "RUB",
            "cashback": 20.0,
            "category": "Супермаркеты",
            "description": "+7 999 888-77-66",
            "Investment bank": 0,
            "add with round": 98.41,
        },
        {
            "date of operation": "12.02.2018 12:40:34",
            "date of currency": "14.02.2018",
            "card number": "*7197",
            "status": "OK",
            "operation": {"add": -314.0, "currency": "RUB"},
            "add": -314.0,
            "currency": "RUB",
            "cashback": 50.0,
            "category": "Фастфуд",
            "description": "OOO Frittella",
            "Investment bank": 0,
            "add with round": 314.0,
        },
        {
            "date of operation": "11.02.2019 15:15:25",
            "date of currency": "13.02.2018",
            "card number": "*7197",
            "status": "OK",
            "operation": {"add": -145.0, "currency": "RUB"},
            "add": -145.0,
            "currency": "RUB",
            "cashback": 1.0,
            "category": "Красота",
            "description": "Арнольд Ш.",
            "Investment bank": 0,
            "add with round": 145.0,
        },
    ]
